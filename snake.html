<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Snake</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#1a1a2e;display:flex;justify-content:center;align-items:center;min-height:100vh;font-family:'Courier New',monospace;color:#eee}
.game{display:flex;flex-direction:column;align-items:center;gap:16px}
canvas{border:3px solid #e94560;background:#16213e}
.hud{display:flex;gap:40px;font-size:18px}
.label{color:#e94560;font-size:11px;text-transform:uppercase;letter-spacing:2px}
.value{font-size:28px;font-weight:bold}
.keys{font-size:12px;color:#666;margin-top:8px}
.keys span{color:#e94560}
#msg{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:22px;display:none;text-align:center;z-index:10;background:rgba(0,0,0,0.85);padding:20px 30px;border:2px solid #e94560;border-radius:8px}
.container{position:relative;display:inline-block}
</style>
</head>
<body>
<div class="game">
  <div class="hud">
    <div><div class="label">Score</div><div class="value" id="score">0</div></div>
    <div><div class="label">High Score</div><div class="value" id="highscore">0</div></div>
    <div><div class="label">Speed</div><div class="value" id="speed">1</div></div>
  </div>
  <div class="container">
    <canvas id="board" width="400" height="400"></canvas>
    <div id="msg"></div>
  </div>
  <div class="keys">
    <span>← → ↑ ↓</span> or <span>WASD</span> Move &nbsp;|&nbsp; <span>Enter</span> Restart &nbsp;|&nbsp; <span>P</span> Pause
  </div>
</div>
<script>
(function(){
  const canvas = document.getElementById('board');
  const ctx = canvas.getContext('2d');
  const msgEl = document.getElementById('msg');
  const GRID = 20;
  const COLS = canvas.width / GRID;
  const ROWS = canvas.height / GRID;

  let snake, dir, nextDir, food, score, highScore, gameOver, paused, speed, interval, lastMove;

  highScore = parseInt(localStorage.getItem('snake-high') || '0');

  function init() {
    snake = [{x:10,y:10},{x:9,y:10},{x:8,y:10}];
    dir = {x:1,y:0};
    nextDir = {x:1,y:0};
    score = 0;
    gameOver = false;
    paused = false;
    speed = 1;
    interval = 150;
    lastMove = 0;
    placeFood();
    msgEl.style.display = 'none';
    updateHUD();
  }

  function placeFood() {
    do {
      food = {x: Math.random()*COLS|0, y: Math.random()*ROWS|0};
    } while(snake.some(s => s.x===food.x && s.y===food.y));
  }

  function updateHUD() {
    document.getElementById('score').textContent = score;
    document.getElementById('highscore').textContent = highScore;
    document.getElementById('speed').textContent = speed;
  }

  function drawBlock(x, y, color, glow) {
    if (glow) {
      ctx.shadowColor = color;
      ctx.shadowBlur = 8;
    }
    ctx.fillStyle = color;
    ctx.fillRect(x*GRID+1, y*GRID+1, GRID-2, GRID-2);
    ctx.shadowBlur = 0;
  }

  function draw() {
    // Background
    ctx.fillStyle = '#16213e';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Grid
    ctx.strokeStyle = 'rgba(255,255,255,0.03)';
    for(let r=0;r<ROWS;r++) for(let c=0;c<COLS;c++) ctx.strokeRect(c*GRID,r*GRID,GRID,GRID);

    // Food with glow
    drawBlock(food.x, food.y, '#e94560', true);

    // Snake
    snake.forEach((seg, i) => {
      if (i === 0) {
        drawBlock(seg.x, seg.y, '#0f0', true);
      } else {
        let g = Math.max(80, 255 - i * 8);
        drawBlock(seg.x, seg.y, `rgb(0,${g},0)`, false);
      }
    });
  }

  function tick() {
    dir = nextDir;
    const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};

    // Wrap around
    if (head.x < 0) head.x = COLS-1;
    if (head.x >= COLS) head.x = 0;
    if (head.y < 0) head.y = ROWS-1;
    if (head.y >= ROWS) head.y = 0;

    // Self collision
    if (snake.some(s => s.x === head.x && s.y === head.y)) {
      gameOver = true;
      if (score > highScore) {
        highScore = score;
        localStorage.setItem('snake-high', highScore);
      }
      msgEl.innerHTML = `GAME OVER<br><small>Score: ${score}</small><br><small>Enter to restart</small>`;
      msgEl.style.display = 'block';
      updateHUD();
      return;
    }

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
      score += 10 * speed;
      // Speed up every 5 food
      if (score % 50 === 0 && interval > 50) {
        interval -= 10;
        speed++;
      }
      placeFood();
      updateHUD();
    } else {
      snake.pop();
    }
  }

  function loop(now) {
    requestAnimationFrame(loop);
    if (gameOver || paused) { draw(); return; }
    if (now - lastMove >= interval) {
      tick();
      lastMove = now;
    }
    draw();
  }

  document.addEventListener('keydown', e => {
    if (gameOver) {
      if (e.key === 'Enter') init();
      return;
    }
    if (e.key === 'p' || e.key === 'P') {
      paused = !paused;
      if (paused) { msgEl.textContent = 'PAUSED'; msgEl.style.display = 'block'; }
      else { msgEl.style.display = 'none'; }
      return;
    }
    const k = e.key;
    if ((k==='ArrowLeft'||k==='a'||k==='A') && dir.x!==1) nextDir={x:-1,y:0};
    else if ((k==='ArrowRight'||k==='d'||k==='D') && dir.x!==-1) nextDir={x:1,y:0};
    else if ((k==='ArrowUp'||k==='w'||k==='W') && dir.y!==1) nextDir={x:0,y:-1};
    else if ((k==='ArrowDown'||k==='s'||k==='S') && dir.y!==-1) { e.preventDefault(); nextDir={x:0,y:1}; }
  });

  // Touch controls
  let touchStart = null;
  canvas.addEventListener('touchstart', e => { touchStart = {x:e.touches[0].clientX, y:e.touches[0].clientY}; });
  canvas.addEventListener('touchend', e => {
    if (!touchStart) return;
    const dx = e.changedTouches[0].clientX - touchStart.x;
    const dy = e.changedTouches[0].clientY - touchStart.y;
    if (Math.abs(dx) > Math.abs(dy)) {
      if (dx > 0 && dir.x !== -1) nextDir = {x:1,y:0};
      else if (dx < 0 && dir.x !== 1) nextDir = {x:-1,y:0};
    } else {
      if (dy > 0 && dir.y !== -1) nextDir = {x:0,y:1};
      else if (dy < 0 && dir.y !== 1) nextDir = {x:0,y:-1};
    }
    touchStart = null;
  });

  init();
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
